<% content_for :title, "Bitcoin Calculator" %>

<section class="calculator" data-controller="animations">
  <div class="calculator__container">
    <header class="calculator__intro" data-animate>
      <p class="calculator__eyebrow">Tools</p>
      <h1>Bitcoin Calculator</h1>
      <p class="calculator__description">
        Paste a private key (hex or WIF) or a public key (compressed or uncompressed) and instantly derive
        matching public keys and addresses. Crafted for security researchers and curious hodlers alike.
      </p>
    </header>

    <div class="calculator__grid">
      <div class="calculator__card calculator__card--input" data-animations-target="card" data-animate="delayed">
        <h2 class="calculator__card-title">Input</h2>
        <p class="calculator__card-subtitle">
          üîí Your data never leaves this page. All calculations occur purely in the browser.
        </p>

        <%= form_with url: calculators_path, scope: :calculator, method: :post, class: "calculator__form", local: true do |form| %>
          <div class="calculator__field">
            <%= form.label :input, "Paste private key, WIF, or public key" %>
            <%= form.text_area :input, value: @input, rows: 7, placeholder: "e.g. 5HueCGU8rMjxEXxiPuD5BDu...", class: "calculator__textarea" %>
          </div>

          <div class="calculator__actions">
            <%= form.submit "Calculate", class: "calculator__submit", data: { action: "click->animations#ripple click->animations#submitForm" } %>
            <small class="calculator__hint">‚ú® Supports mainnet hex, WIF, and public key formats.</small>
          </div>
        <% end %>
      </div>

      <% if defined?(@result) && @result.present? %>
        <div class="calculator__card calculator__card--results" data-animations-target="card" data-animate="late">
          <div class="calculator__results-header">
            <h2 class="calculator__card-title">Results</h2>
            <p class="calculator__badge"><%= @result.input_type.to_s.humanize %></p>
          </div>

          <% if @result.errors.present? %>
            <div class="calculator__results-errors">
              <h3>‚ö†Ô∏è We hit a snag</h3>
              <ul>
                <% @result.errors.each do |error| %>
                  <li><%= error %></li>
                <% end %>
              </ul>
            </div>
          <% else %>
            <dl class="calculator__details">
              <% @result.data.each do |label, value| %>
                <div class="calculator__details-row">
                  <dt><%= label.to_s.humanize %></dt>
                  <dd data-animations-target="copyable" data-tooltip="Click to copy"><code><%= value %></code></dd>
                </div>
              <% end %>
            </dl>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</section>
